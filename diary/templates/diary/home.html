<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–î–Ω–µ–≤–Ω–∏–∫</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container py-4">
    <p class="text-end">
      üëã –ü—Ä–∏–≤–µ—Ç, {{ user.username }} |
      <a href="{% url 'logout' %}">–í—ã—Ö–æ–¥</a>
    </p>

    <h1 class="mb-4">üìò –î–Ω–µ–≤–Ω–∏–∫</h1>
    <p class="text-muted">–ó–∞–ø–∏—Å–µ–π: {{ count }}</p>
    <a class="btn btn-primary mb-4" href="{% url 'create_entry' %}">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å</a>

    <!-- üîé –§–æ—Ä–º–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ -->
    <form method="get" class="row g-3 mb-4 align-items-end">
        <div class="col-md-4">
            <input type="text" name="q" value="{{ query|default:'' }}" class="form-control" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É">
        </div>

        <div class="col-md-3">
            <select name="category" class="form-select">
                <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                {% for cat in categories %}
                    <option value="{{ cat.id }}" {% if cat.id == active_category %}selected{% endif %}>
                        {{ cat.name }}
                    </option>
                {% endfor %}
            </select>
        </div>

        <div class="col-md-3">
            <input type="date" name="date" value="{{ active_date|default:'' }}" class="form-control">
        </div>

        <div class="col-md-2 d-flex gap-2">
            <button type="submit" class="btn btn-outline-primary w-100">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
            <a href="{% url 'home' %}" class="btn btn-outline-secondary">‚úñÔ∏è</a>
        </div>
    </form>

    {% if entries %}
        <ul class="list-group">
        {% for entry in entries %}
            <li class="list-group-item">
                <a href="{% url 'view_entry' entry.id %}">
                    <strong>{{ entry.title }}</strong>
                </a>

                {% if entry.categories.all %}
                    <div class="mt-1">
                        {% for cat in entry.categories.all %}
                            <span class="badge bg-info text-dark">{{ cat.name }}</span>
                        {% endfor %}
                    </div>
                {% endif %}

                <small class="text-muted d-block">{{ entry.created_at|date:"j E Y, H:i" }}</small>
            </li>
        {% endfor %}
        </ul>
    {% else %}
        <div class="alert alert-info">–ó–∞–ø–∏—Å–µ–π –ø–æ–∫–∞ –Ω–µ—Ç.</div>
    {% endif %}
</div>

</body>
</html>