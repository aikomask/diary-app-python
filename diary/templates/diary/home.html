{% extends 'diary/base.html' %}

{% block title %}–î–Ω–µ–≤–Ω–∏–∫{% endblock %}

{% block content %}
<h1 class="mb-4">üìò –î–Ω–µ–≤–Ω–∏–∫</h1>
<p class="text-muted">–ó–∞–ø–∏—Å–µ–π: {{ count }}</p>

<div class="mb-4 d-flex gap-2">
    <a class="btn btn-outline-success" href="{% url 'diary_stats' %}">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</a>
    <a class="btn btn-outline-info" href="{% url 'chart' %}">üìà –ì—Ä–∞—Ñ–∏–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</a>
    <a class="btn {% if theme == 'pink' %}btn-danger{% else %}btn-primary{% endif %}" href="{% url 'create_entry' %}">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å</a>
</div>

<form method="get" class="row g-3 mb-4 align-items-end">
    <div class="col-md-4">
        <input type="text" name="q" value="{{ query|default:'' }}" class="form-control" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É">
    </div>

    <div class="col-md-3">
        <select name="category" class="form-select">
            <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
            {% for cat in categories %}
                <option value="{{ cat.id }}" {% if cat.id == active_category %}selected{% endif %}>
                    {{ cat.name }}
                </option>
            {% endfor %}
        </select>
    </div>

    <div class="col-md-3">
        <input type="date" name="date" value="{{ active_date|default:'' }}" class="form-control">
    </div>

    <div class="col-md-2 d-flex gap-2">
        <button type="submit" class="btn {% if theme == 'pink' %}btn-danger{% else %}btn-outline-primary{% endif %} w-100">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
        <a href="{% url 'home' %}" class="btn btn-outline-secondary">‚úñÔ∏è</a>
    </div>
</form>

{% if entries %}
    <ul class="list-group">
    {% for entry in entries %}
        <li class="list-group-item {% if theme == 'pink' %}bg-light{% endif %}">
            <a href="{% url 'view_entry' entry.id %}">
                <strong>
                  {% if entry.is_pinned %}üìå {% endif %}
                  {{ entry.title }}
                </strong>
            </a>

            {% if entry.categories.all %}
                <div class="mt-1">
                    {% for cat in entry.categories.all %}
                        <span class="badge bg-info text-dark">{{ cat.name }}</span>
                    {% endfor %}
                </div>
            {% endif %}

            <small class="text-muted d-block">{{ entry.created_at|date:"j E Y, H:i" }}</small>
        </li>
    {% endfor %}
    </ul>
{% else %}
    <div class="alert alert-info">–ó–∞–ø–∏—Å–µ–π –ø–æ–∫–∞ –Ω–µ—Ç.</div>
{% endif %}
{% endblock %}
