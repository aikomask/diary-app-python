{% extends 'diary/base.html' %}

{% block title %}üìò My Qalam{% endblock %}

{% block content %}
<!-- –§–∏–ª—å—Ç—Ä—ã –ø–æ–∏—Å–∫–∞ -->
<div class="mb-6 flex flex-wrap items-center gap-4 justify-between">
    <form method="get" class="flex flex-wrap gap-3 items-center flex-grow max-w-3xl">
        <input
            type="text"
            name="q"
            value="{{ query|default:'' }}"
            placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É"
            class="flex-grow min-w-[200px] px-3 py-2 border border-gray-300 rounded-md focus:outline-indigo-500"
        />

        <select name="category" class="px-3 py-2 border border-gray-300 rounded-md">
            <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
            {% for cat in categories %}
                <option value="{{ cat.id }}" {% if cat.id == active_category %}selected{% endif %}>
                    {{ cat.name }}
                </option>
            {% endfor %}
        </select>

        <input
            type="date"
            name="date"
            value="{{ active_date|default:'' }}"
            class="px-3 py-2 border border-gray-300 rounded-md"
        />

        <button
            type="submit"
            class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold px-4 py-2 rounded-md"
        >
            –ü—Ä–∏–º–µ–Ω–∏—Ç—å
        </button>

        <a href="{% url 'home' %}" class="text-gray-500 hover:text-gray-700 px-2 py-2 rounded-md cursor-pointer">‚úñÔ∏è –°–±—Ä–æ—Å–∏—Ç—å</a>
    </form>

    <a
        href="{% url 'create_entry' %}"
        class="ml-auto bg-indigo-600 hover:bg-indigo-700 text-white font-semibold px-4 py-2 rounded-md"
    >
        –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å
    </a>
</div>

<h1 class="text-3xl font-bold mb-6">üìò My Qalam</h1>
<p class="mb-4 text-gray-600">–í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π: {{ count }}</p>

<!-- –°–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π -->
{% if entries %}
    <ul class="space-y-4">
        {% for entry in entries %}
            <li class="p-4 bg-white rounded-lg shadow hover:shadow-md transition">
                <a href="{% url 'view_entry' entry.id %}" class="text-lg font-semibold hover:text-indigo-600 flex items-center gap-2">
                    {% if entry.is_pinned %}üìå{% endif %} {{ entry.title }}
                </a>

                {% if entry.categories.all %}
                    <div class="mt-1 flex flex-wrap gap-2">
                        {% for cat in entry.categories.all %}
                            <span class="bg-indigo-100 text-indigo-800 text-xs font-medium px-2 py-0.5 rounded">{{ cat.name }}</span>
                        {% endfor %}
                    </div>
                {% endif %}

                <p class="mt-2 text-gray-500 text-sm">{{ entry.created_at|date:"j E Y, H:i" }}</p>
            </li>
        {% endfor %}
    </ul>
{% else %}
    <div class="text-center text-gray-500 py-10">–ó–∞–ø–∏—Å–µ–π –ø–æ–∫–∞ –Ω–µ—Ç.</div>
{% endif %}
{% endblock %}
